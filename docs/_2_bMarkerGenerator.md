# bMarkerGenerator


## (1) Introduction

In most association test framework, a marker is supposed to represent only 2 factors. This assumption is appropriate because the most of genomic positions are actually bi-allelic. However, there are some genomic positions where more than 2 kind of SNP alleles can be found, i.e. tri-allelic or more. Most of genomic positions in HLA region are not bi-allelic due to its polymorphic characteristic. Furthermore, when it comes to  amino acid residue sequence of which the positions can have roughly 22 kinds of amino acid residues, it's impossible to perform the conventional association test just as it is.

bMarkerGenerator provides a solution for this. For each position which has more than 2 factors, bMarkerGenerator generates binary markers where each fator is allocated disjointly and represent its 'P'resence' or 'A'bsence. For example, assume one position of amino acid sequence has 3 factors, e.g. V(Valine), S(Serine), P(Proline). Then three binary markers, 'AA_A_-12_30018537_V', 'AA_A_-12_30018537_S' and 'AA_A_-12_30018537_P', are generated by bMarkerGenerator. By extending this idea one step further, Markers like 'AA_A_-12_30018537_VS' represent the existence of the case where there both factors 'Valine' and 'Serine' are. Then, the generated marker panel will be used for association test.


## (2) Four classes of marker to be used.

Aside from commonly used SNP variant markers(ex. rs41557221), 3 classes of marker related to HLA will be included in the generated panel.

1. HLA allele binary marker (ex. HLA_A_0101)
2. Amino acid residue binary marker (ex. AA_A_9_30018537_F, AA_A_-15_30018338)
3. DNA sequence base pair binary marker (ex. SNP_A_30018457, SNP_A_30018461_A)
4. SNP variant marker (Optional) (ex. rs41557221)


## (3) Usage example

(1) Typical usage

```
python3 HATK.py \
    --bmarkergenerator \
    --variants example/wtccc_filtered_58C_RA.hatk.58C_RA.300+300 \
    --chped example/wtccc_filtered_58C_RA.hatk.58C_RA.300+300.imgt3320.4field.chped \
    --out tests/_2_b_MarkerGenerator/20190829_RA_300_300/20190702_wtccc_filtered_58C_RA.hatk.58C_RA.300+300 \
    -hg 18 \
    --dict-AA tests/_1_IMGT2Sequence/20190829_hg19_imgt3320/HLA_DICTIONARY_AA.hg19.imgt3320 \
    --dict-SNPS tests/_1_IMGT2Sequence/20190829_hg19_imgt3320/HLA_DICTIONARY_SNPS.hg19.imgt3320
```

Here, '--chped' takes the output from NomenCleaner. '--dict-AA' and '--dict-SNPS' take the output from IMGT2Seq.

(2) Just HLA markers. (No SNP variant markers; Only 3 classes of HLA related markers)

Don't include '--variant' argument in above useage example.

```
python3 HATK.py \
    --bmarkergenerator \
    --chped example/wtccc_filtered_58C_RA.hatk.58C_RA.300+300.imgt3320.4field.chped \
    --out tests/_2_b_MarkerGenerator/20190829_RA_300_300/20190702_wtccc_filtered_58C_RA.hatk.58C_RA.300+300 \
    -hg 18 \
    --dict-AA tests/_1_IMGT2Sequence/20190829_hg19_imgt3320/HLA_DICTIONARY_AA.hg19.imgt3320 \
    --dict-SNPS tests/_1_IMGT2Sequence/20190829_hg19_imgt3320/HLA_DICTIONARY_SNPS.hg19.imgt3320
```
